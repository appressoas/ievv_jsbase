<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <base data-ice="baseUrl" href="../../../">
  <title data-ice="title">source/http/QueryString.js | ievv_jsbase API Document</title>
  <link type="text/css" rel="stylesheet" href="css/style.css">
  <link type="text/css" rel="stylesheet" href="css/prettify-tomorrow.css">
  <script src="script/prettify/prettify.js"></script>
  
  
  <script src="script/manual.js"></script>
</head>
<body class="layout-container" data-ice="rootContainer">

<header>
  <a href="./">Home</a>
  <a href="./manual/index.html" data-ice="manualHeaderLink">Manual</a>
  <a href="identifiers.html">Reference</a>
  <a href="source.html">Source</a>
  
  
  <div class="search-box">
  <span>
    <img src="./image/search.png">
    <span class="search-input-edge"></span><input class="search-input"><span class="search-input-edge"></span>
  </span>
    <ul class="search-result"></ul>
  </div>
</header>

<nav class="navigation" data-ice="nav"><div>
  <ul>
    
  <li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/source/SignalHandlerSingleton.js~ReceivedSignalInfo.html">ReceivedSignalInfo</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/source/SignalHandlerSingleton.js~SentSignalInfo.html">SentSignalInfo</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/source/SignalHandlerSingleton.js~SignalHandlerSingleton.html">SignalHandlerSingleton</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-makeCustomError">makeCustomError</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-DuplicateReceiverNameForSignal">DuplicateReceiverNameForSignal</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">__testhelpers__</div><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/source/__testhelpers__/XMLHttpRequestMock.js~XMLHttpRequestMock.html">XMLHttpRequestMock</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">dom</div><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/source/dom/DOMReplace.js~DOMReplace.html">DOMReplace</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/source/dom/DOMReplaceFromUrl.js~DOMReplaceFromUrl.html">DOMReplaceFromUrl</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/source/dom/DOMReplaceWithSameElementFromUrl.js~DOMReplaceWithSameElementFromUrl.html">DOMReplaceWithSameElementFromUrl</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/source/dom/HtmlParser.js~HtmlParser.html">HtmlParser</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/source/dom/ScriptLoaderSingleton.js~Script.html">Script</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/source/dom/ScriptLoaderSingleton.js~ScriptLoaderSingleton.html">ScriptLoaderSingleton</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">html</div><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/source/html/CleanHtml.js~CleanHtml.html">CleanHtml</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/source/html/CleanHtml.js~CleanHtmlOptions.html">CleanHtmlOptions</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/source/html/CleanHtml.js~CleanHtmlParser.html">CleanHtmlParser</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/source/html/CleanHtml.js~CleanerNode.html">CleanerNode</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/source/html/CleanHtml.js~FlatListCleanerNode.html">FlatListCleanerNode</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/source/html/CleanHtml.js~NoTextCleanerNode.html">NoTextCleanerNode</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-attributeObjectToHtml">attributeObjectToHtml</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-escapeAttributeValue">escapeAttributeValue</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-isInlineTag">isInlineTag</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-isSelfClosingTag">isSelfClosingTag</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-makeHtmlEndTag">makeHtmlEndTag</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-makeHtmlStartTag">makeHtmlStartTag</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-PasteMarkerNotSetError">PasteMarkerNotSetError</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">http</div><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/source/http/HttpCookies.js~HttpCookies.html">HttpCookies</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/source/http/HttpDjangoFileRequest.js~HttpDjangoFileRequest.html">HttpDjangoFileRequest</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/source/http/HttpDjangoJsonRequest.js~HttpDjangoJsonRequest.html">HttpDjangoJsonRequest</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/source/http/HttpFileRequest.js~HttpFileRequest.html">HttpFileRequest</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/source/http/HttpFileResponse.js~HttpFileResponse.html">HttpFileResponse</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/source/http/HttpJsonRequest.js~JsonHttpRequest.html">JsonHttpRequest</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/source/http/HttpJsonResponse.js~HttpJsonResponse.html">HttpJsonResponse</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/source/http/HttpRequest.js~HttpRequest.html">HttpRequest</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/source/http/HttpResponse.js~HttpResponse.html">HttpResponse</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/source/http/QueryString.js~QueryString.html">QueryString</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/source/http/UrlParser.js~UrlParser.html">UrlParser</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-HttpCookieNotFoundError">HttpCookieNotFoundError</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-HttpResponseError">HttpResponseError</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">log</div><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/source/log/AbstractLogger.js~AbstractLogger.html">AbstractLogger</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/source/log/Logger.js~Logger.html">Logger</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/source/log/LoggerSingleton.js~LoggerSingleton.html">LoggerSingleton</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/source/log/loglevel.js~LogLevels.html">LogLevels</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">polyfill</div><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-elementRemovePolyfill">elementRemovePolyfill</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">utils</div><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/source/utils/ObjectManager.js~ObjectManager.html">ObjectManager</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/source/utils/PrettyFormat.js~PrettyFormat.html">PrettyFormat</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/source/utils/TypeConvert.js~TypeConvert.html">TypeConvert</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getFileExtension">getFileExtension</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-onDocumentReady">onDocumentReady</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-ensureMapHasDataInReduxStore">ensureMapHasDataInReduxStore</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getObjectFromReduxMapOrNullIfLoading">getObjectFromReduxMapOrNullIfLoading</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getValuesFromTypeMappedReduxMap">getValuesFromTypeMappedReduxMap</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-makeApiDataMapDeleted">makeApiDataMapDeleted</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-makeApiDataMapError">makeApiDataMapError</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-makeApiDataMapIsLoading">makeApiDataMapIsLoading</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-makeApiDataMapNewData">makeApiDataMapNewData</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-makeImmutableOrderedMapFromValueArray">makeImmutableOrderedMapFromValueArray</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-makeTypeMappedReduxMapFromApiData">makeTypeMappedReduxMapFromApiData</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-typeDetect">typeDetect</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-TYPE_MAPPED_REDUX_MAP_DEFAULT_KEY">TYPE_MAPPED_REDUX_MAP_DEFAULT_KEY</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">widget</div><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/source/widget/AbstractWidget.js~AbstractWidget.html">AbstractWidget</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/source/widget/WidgetRegistrySingleton.js~WidgetRegistrySingleton.html">WidgetRegistrySingleton</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-ElementHasNoWidgetInstanceIdError">ElementHasNoWidgetInstanceIdError</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-ElementIsNotInitializedAsWidget">ElementIsNotInitializedAsWidget</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-ElementIsNotWidgetError">ElementIsNotWidgetError</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-InvalidWidgetAliasError">InvalidWidgetAliasError</a></span></span></li>
</ul>
</div>
</nav>

<div class="content" data-ice="content"><h1 data-ice="title">source/http/QueryString.js</h1>
<pre class="source-code line-number raw-source-code"><code class="prettyprint linenums" data-ice="content">import typeDetect from &apos;../utils/typeDetect&apos;

/**
 * Query-string creator and parser.
 *
 * @example &lt;caption&gt;Basics - build a querystring&lt;/caption&gt;
 * const querystring = new QueryString();
 * querystring.set(&apos;name&apos;, &apos;Peter&apos;);
 * querystring.setIterable(&apos;tags&apos;, [&apos;person&apos;, &apos;male&apos;]);
 * const encodedQuerystring = querystring.urlencode();
 * // encodedQuerystring === &apos;name=Peter&amp;tags=person&amp;tags=male&apos;  // order may vary
 *
 * @example &lt;caption&gt;Parse a querystring&lt;/caption&gt;
 * const querystring = new QueryString(&apos;name=Peter&amp;tags=person&amp;tags=male&apos;);
 * const name = querystring.get(&apos;name&apos;);
 * const tags = querystring.getArray(&apos;tags&apos;);
 * const firstTag = querystring.get(&apos;tags&apos;);
 *
 * @example &lt;caption&gt;Parse a querystring from window.location.search&lt;/caption&gt;
 * // window.location.search == &quot;?name=test&amp;age=12&quot;
 * const querystring = new QueryString(window.location.search);
 * const name = querystring.get(&apos;name&apos;);
 * const age = querystring.get(&apos;age&apos;);
 *
 * @example &lt;caption&gt;Parse and modify a querystring&lt;/caption&gt;
 * const querystring = new QueryString(&apos;name=Peter&amp;tags=person&amp;tags=male&apos;);
 * querystring.set(&apos;name&apos;, &apos;John&apos;);
 * querystring.append(&apos;tags&apos;, &apos;important&apos;);
 * // querystring.urlencode() === &apos;name=John&amp;tags=person&amp;tags=male&amp;tags=important&apos;
 * querystring.setIterable(&apos;tags&apos;, [&apos;male&apos;]);
 * // querystring.urlencode() === &apos;name=John&amp;tags=male&apos;
 */
export default class QueryString {
  /**
   *
   * @param {string} querystring Optional input querystring to parse.
   */
  constructor(querystring=&apos;&apos;) {
    this._queryStringMap = new Map();
    if(querystring) {
      if(typeof querystring !== &apos;string&apos;) {
        throw new TypeError(&apos;The querystring argument must be a string.&apos;)
      }
      this._parseQueryString(querystring);
    }
  }

  /**
   * Create a deep copy of this QueryString object.
   *
   * @return The copy.
   */
  deepCopy () {
    let copy = Object.assign(Object.create(this), this)
    copy._queryStringMap = new Map(this._queryStringMap)
    return copy
  }

  /**
   * Returns ``true`` if the querystring is empty, otherwise ``false``.
   *
   * @returns {boolean}
   */
  isEmpty() {
    return this._queryStringMap.size === 0;
  }

  /**
   * Remove all keys and values from the QueryString.
   */
  clear() {
    this._queryStringMap.clear();
  }

  _parseQueryStringItem(querystringItem) {
    const splitPair = querystringItem.split(&apos;=&apos;);
    const key = decodeURIComponent(splitPair[0]);
    const value = decodeURIComponent(splitPair[1]);
    this.append(key, value);
  }

  _parseQueryString(querystring) {
    if(querystring.substring(0, 1) == &apos;?&apos;) {
      querystring = querystring.substring(1);
    }
    const splitQueryString = querystring.split(&apos;&amp;&apos;);
    for(const querystringItem of splitQueryString) {
      this._parseQueryStringItem(querystringItem);
    }
  }

  _addToKey(key, value) {
    this._queryStringMap.get(key).push(value);
  }

  _setKeyToEmptyArray(key) {
    this._queryStringMap.set(key, []);
  }

  /**
   * Set values from a querystring, like window.location.search.
   *
   * Overwrites any key/value pairs currently in this object with keys in the
   * provided ``querystring``.
   *
   * @example
   * const querystring = new QueryString();
   * querystring.set(&apos;name&apos;, &apos;oldname&apos;);
   * querystring.addValuesFromQueryString(&apos;name=newname&amp;age=33&apos;);
   * // querystring.get(&apos;name&apos;) == &apos;newname&apos;
   * // querystring.get(&apos;age&apos;) == &apos;33&apos;
   *
   * @param {string} querystring A querystring, like the one in window.location.search.
   *    Examples: ``&quot;?a=10&quot;``, ``&quot;a=10&quot;``, ``&quot;a=10&amp;s=test&quot;``.
   */
  setValuesFromQueryString(querystring) {
    this.merge(new this.constructor(querystring));
  }

  /**
   * Set values from an Object.
   *
   * Overwrites any key/value pairs currently in this QueryString
   * with key/value pairs in the provided ``object``.
   *
   * Uses {@link QueryString#setSmart} to set the values, so
   * the values of the map can be both simple types and
   * iterables like arrays and sets.
   *
   * @example
   * const querystring = new QueryString();
   * querystring.set(&apos;name&apos;, &apos;oldname&apos;);
   * querystring.addValuesFromObject({
   *   name: &apos;newname&apos;,
   *   age: 33,
   *   tags: [&apos;tag1&apos;, &apos;tag2&apos;]
   * });
   * // querystring.get(&apos;name&apos;) == &apos;newname&apos;
   * // querystring.get(&apos;age&apos;) == 33
   * // querystring.getArray(&apos;tags&apos;) == [&apos;tag1&apos;, &apos;tag2&apos;]
   *
   * @param {Object} object An Object.
   */
  setValuesFromObject(object) {
    for(let key of Object.keys(object)) {
      this.setSmart(key, object[key]);
    }
  }

  /**
   * Set values from a Map.
   *
   * Overwrites any key/value pairs currently in this QueryString
   * with key/value pairs in the provided ``map``.
   *
   * Uses {@link QueryString#setSmart} to set the values, so
   * the values of the map can be both simple types and
   * iterables like arrays and sets.
   *
   * @example
   * const querystring = new QueryString();
   * querystring.set(&apos;name&apos;, &apos;oldname&apos;);
   * querystring.addValuesFromMap(new Map([
   *   [&apos;name&apos;, &apos;newname&apos;],
   *   [&apos;age&apos;, 33],
   *   [&apos;tags&apos;, [&apos;tag1&apos;, &apos;tag2&apos;]]
   * ]));
   * // querystring.get(&apos;name&apos;) == &apos;newname&apos;
   * // querystring.get(&apos;age&apos;) == 33
   * // querystring.getArray(&apos;tags&apos;) == [&apos;tag1&apos;, &apos;tag2&apos;]
   *
   * @param {Map} map A map.
   */
  setValuesFromMap(map) {
    for(let [key, value] of map.entries()) {
      this.setSmart(key, value);
    }
  }

  /**
   * Merge {@link QueryString} objects into with this object.
   *
   * Overwrites any key/value pairs currently in this object with keys in the
   * provided queryStringObjects in provided order, with the last
   * one overwriting any preceding values.
   *
   * @example
   * const querystring = new QueryString(&apos;name=oldname&apos;);
   * querystring.merge(
   *    new QueryString(&apos;name=newname1&amp;age=33&apos;),
   *    new QueryString(&apos;name=newname2&amp;size=large&apos;));
   * // querystring.get(&apos;name&apos;) == &apos;newname2&apos;
   * // querystring.get(&apos;age&apos;) == &apos;33&apos;
   * // querystring.get(&apos;size&apos;) == &apos;large&apos;
   *
   * @param queryStringObjects Zero or more {@link QueryString} objects.
   */
  merge(...queryStringObjects) {
    for(let queryStringObject of queryStringObjects) {
      for (let [key, value] of queryStringObject._queryStringMap) {
        this._queryStringMap.set(key, value);
      }
    }
  }

  /**
   * Set value from an iterable.
   *
   * @param {string} key The key to set.
   * @param iterable Something that can be iterated with a
   *      ``for(const value of iterable)`` loop.
   *      All the values in the iterable must be strings.
   *      If the iterable is empty the key will be removed
   *      from the QueryString.
   *
   * @example
   * const querystring = QueryString();
   * querystring.setIterable(&apos;names&apos;, [&apos;Peter&apos;, &apos;Jane&apos;]);
   */
  setIterable(key, iterable) {
    this._setKeyToEmptyArray(key);
    for(const value of iterable) {
      this._addToKey(key, value);
    }
    if(this._queryStringMap.get(key).length === 0) {
      this.remove(key);
    }
  }

  /**
   * Set a value.
   *
   * @param {string} key The key to store the value as.
   * @param {string} value The value to set.
   *
   * @example
   * const querystring = QueryString();
   * querystring.set(&apos;name&apos;, &apos;Peter&apos;);
   */
  set(key, value) {
    this.setIterable(key, [value]);
  }

  /**
   * Calls {@link QueryString#set} or {@link QueryString#setIterable} depending
   * on the type of the provided value.
   *
   * @param {string} key The key to store the value as.
   * @param {string|number|boolean|array|Set} value The value to set using
   *    {@link QueryString#set} or {@link QueryString#setIterable} depending
   *    on the type.
   */
  setSmart(key, value) {
    const valueType = typeDetect(value)
    if(valueType === &apos;string&apos; || valueType === &apos;number&apos; || valueType === &apos;boolean&apos;) {
      this.set(key, value)
    } else if(valueType === &apos;array&apos; || valueType === &apos;set&apos;) {
      this.setIterable(key, value)
    } else {
      throw new Error(`Unsupporter value type: ${valueType}`)
    }
  }

  /**
   * Get a value.
   *
   * @param {string} key The key to get the value for.
   * @param {string} fallback An optional fallback value if the key is
   *      not in the QueryString. Defaults to ``undefined``.
   */
  get(key, fallback) {
    const value = this._queryStringMap.get(key);
    if(typeof value === &apos;undefined&apos;) {
      return fallback;
    } else {
      return value[0];
    }
  }

  /**
   * Append a value to a key.
   *
   * @param {string} key The key to append a value to.
   * @param {string} value The value to append.
   *
   * @example
   * const querystring = QueryString();
   * querystring.append(&apos;names&apos;, &apos;Jane&apos;);
   * querystring.append(&apos;names&apos;, &apos;Joe&apos;);
   * // querystring.urlencode() === &apos;names=Jane&amp;names=Joe&apos;
   */
  append(key, value) {
    if (!this._queryStringMap.has(key)) {
      this._setKeyToEmptyArray(key);
    }
    this._addToKey(key, value);
  }

  /**
   * Get the values for the specified key as an array.
   *
   * Always returns an array, even if the value was set
   * with {@link QueryString#set}.
   *
   * @param {string} key The key to get the values for.
   * @param {Array} fallback An optional fallback value if they
   *      key is not in the QueryString. Defaults to an empty array.
   * @returns {Array}
   */
  getArray(key, fallback) {
    if (this._queryStringMap.has(key)) {
      const valueArray = this._queryStringMap.get(key);
      return Array.from(valueArray);
    }
    if(typeof falback !== &apos;undefined&apos;) {
      return [];
    }
    return fallback;
  }

  /**
   * Remove the specified key from the QueryString.
   *
   * @param {string} key The key to remove.
   */
  remove(key) {
    this._queryStringMap.delete(key);
  }

  /**
   * Check if the QueryString contains the given key.
   *
   * @param {string} key The key to check for.
   * @returns {boolean}
   */
  has(key) {
    return this._queryStringMap.has(key);
  }

  _encodeKeyValue(key, value) {
    key = `${key}`;
    value = `${value}`;
    return `${encodeURIComponent(key)}=${encodeURIComponent(value)}`;
  }

  /**
   * Get the QueryString object as a string in query-string format.
   *
   * @example
   * const querystring = QueryString();
   * querystring.set(&apos;next&apos;, &apos;/a&amp;b/&apos;);
   * querystring.set(&apos;name&apos;, &apos;john&apos;);
   * let urlEncodedQuerystring = querystring.urlencode();
   * // urlEncodedQuerystring === &apos;name=john&amp;next=%2Fa%26b%2F&apos;  // order may vary
   *
   * @example &lt;caption&gt;Sort keys&lt;/caption&gt;
   * const querystring = QueryString();
   * querystring.set(&apos;name&apos;, &apos;john&apos;);
   * querystring.set(&apos;age&apos;, 33);
   * let urlEncodedQuerystring = querystring.urlencode({sortKeys: true});
   * // urlEncodedQuerystring === &apos;age=33&amp;name=john&apos;
   *
   * @example &lt;caption&gt;Sort values&lt;/caption&gt;
   * const querystring = QueryString();
   * querystring.setIterable(&apos;name&apos;, [&apos;john&apos;, &apos;amy&apos;, &apos;xion&apos;]);
   * let urlEncodedQuerystring = querystring.urlencode();
   * // urlEncodedQuerystring === &apos;name=amy&amp;name=john&amp;name=xion&apos;
   *
   *
   * @param {Object} options Options. All are optional
   * @param {boolean} options.sortKeys Sort the keys using Array.sort? ``false`` by default.
   * @param {boolean} options.sortValues Sort the values using Array.sort? ``false`` by default.
   *    This only makes sense if you have keys with multiple values.
   * @param {boolean} options.skipEmptyValues Skip empty values? ``false`` by default.
   */
  urlencode(options={}) {
    const {sortKeys, sortValues, skipEmptyValues} = options
    let keys = this._queryStringMap.keys()
    if(sortKeys) {
      keys = Array.from(keys)
      keys.sort()
    }

    let urlEncodedArray = [];
    for(let key of keys) {
      let valueArray = this._queryStringMap.get(key);
      if(sortValues) {
        valueArray = Array.from(valueArray)
        valueArray.sort()
      }
      for(const value of valueArray) {
        if(skipEmptyValues &amp;&amp; `${value}` === &apos;&apos;) {
          continue
        }
        urlEncodedArray.push(this._encodeKeyValue(key, value));
      }
    }
    return urlEncodedArray.join(&apos;&amp;&apos;);
  }
}
</code></pre>

</div>

<footer class="footer">
  Generated by <a href="https://esdoc.org">ESDoc<span data-ice="esdocVersion">(0.4.8)</span></a>
</footer>

<script src="script/search_index.js"></script>
<script src="script/search.js"></script>
<script src="script/pretty-print.js"></script>
<script src="script/inherited-summary.js"></script>
<script src="script/test-summary.js"></script>
<script src="script/inner-link.js"></script>
<script src="script/patch-for-local.js"></script>
</body>
</html>
